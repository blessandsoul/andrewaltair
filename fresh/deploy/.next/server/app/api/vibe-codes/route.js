"use strict";(()=>{var e={};e.id=1432,e.ids=[1432],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6848:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>f,patchFetch:()=>h,requestAsyncStorage:()=>g,routeModule:()=>x,serverHooks:()=>A,staticGenerationAsyncStorage:()=>m});var r={};s.r(r),s.d(r,{DELETE:()=>d,GET:()=>p,PATCH:()=>l,POST:()=>c});var o=s(49303),n=s(88716),a=s(60670),u=s(87070);let i=new Map;async function c(e){try{let{type:t,duration:s,maxUsage:r=1}=await e.json(),o=function(e=6){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",s="";for(let r=0;r<e;r++)s+=t.charAt(Math.floor(Math.random()*t.length));return s}(),n=Date.now(),a=n+(s||36e5);return i.set(o,{type:t||"full",expiresAt:a,usageCount:0,maxUsage:r,createdAt:n}),u.NextResponse.json({success:!0,code:o,expiresAt:a,type:t,maxUsage:r})}catch(e){return u.NextResponse.json({success:!1,error:"Failed to generate code"},{status:500})}}async function p(e){let t=e.nextUrl.searchParams.get("code");if(!t)return u.NextResponse.json({success:!1,error:"Code is required"},{status:400});let s=i.get(t);if(!s)return u.NextResponse.json({success:!1,error:"Неверный код"});let r=Date.now();return r>s.expiresAt?(i.delete(t),u.NextResponse.json({success:!1,error:"Код истек"})):s.usageCount>=s.maxUsage?u.NextResponse.json({success:!1,error:"Код уже использован"}):(s.usageCount++,s.usedAt=r,u.NextResponse.json({success:!0,type:s.type,expiresAt:s.expiresAt,articleId:s.articleId,remainingTime:s.expiresAt-r}))}async function d(e){let t=e.nextUrl.searchParams.get("code");if(!t)return u.NextResponse.json({success:!1,error:"Code is required"},{status:400});let s=i.delete(t);return u.NextResponse.json({success:s,message:s?"Code deleted":"Code not found"})}async function l(){let e=Array.from(i.entries()).map(([e,t])=>({code:e,type:t.type,usageCount:t.usageCount,maxUsage:t.maxUsage,createdAt:new Date(t.createdAt).toISOString(),expiresAt:new Date(t.expiresAt).toISOString(),isExpired:Date.now()>t.expiresAt,isUsedUp:t.usageCount>=t.maxUsage}));return u.NextResponse.json({success:!0,totalCodes:i.size,codes:e})}let x=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/vibe-codes/route",pathname:"/api/vibe-codes",filename:"route",bundlePath:"app/api/vibe-codes/route"},resolvedPagePath:"C:\\Users\\User\\Desktop\\GITHUB\\andrewaltair\\fresh\\src\\app\\api\\vibe-codes\\route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:g,staticGenerationAsyncStorage:m,serverHooks:A}=x,f="/api/vibe-codes/route";function h(){return(0,a.patchFetch)({serverHooks:A,staticGenerationAsyncStorage:m})}}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[8948,5972],()=>s(6848));module.exports=r})();