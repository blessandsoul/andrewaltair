"use strict";(()=>{var e={};e.id=7532,e.ids=[7532],e.modules={11185:e=>{e.exports=require("mongoose")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},81729:(e,t,n)=>{n.r(t),n.d(t,{originalPathname:()=>h,patchFetch:()=>x,requestAsyncStorage:()=>f,routeModule:()=>l,serverHooks:()=>y,staticGenerationAsyncStorage:()=>g});var r={};n.r(r),n.d(r,{DELETE:()=>c,GET:()=>u,PUT:()=>p});var o=n(49303),s=n(88716),a=n(60670),i=n(87070),d=n(75748),m=n(84283);async function u(e,{params:t}){try{await (0,d.Z)();let{id:e}=await t,n=await m.Z.findById(e).lean();if(!n)return i.NextResponse.json({error:"Comment not found"},{status:404});return i.NextResponse.json({comment:{...n,id:n._id.toString()}})}catch(e){return console.error("Get comment error:",e),i.NextResponse.json({error:"Failed to fetch comment"},{status:500})}}async function p(e,{params:t}){try{await (0,d.Z)();let{id:n}=await t,r=await e.json();delete r.id,delete r._id;let o=await m.Z.findByIdAndUpdate(n,{$set:r},{new:!0,runValidators:!0}).lean();if(!o)return i.NextResponse.json({error:"Comment not found"},{status:404});return i.NextResponse.json({success:!0,comment:{...o,id:o._id.toString()}})}catch(e){return console.error("Update comment error:",e),i.NextResponse.json({error:"Failed to update comment"},{status:500})}}async function c(e,{params:t}){try{await (0,d.Z)();let{id:e}=await t;if(!await m.Z.findByIdAndDelete(e))return i.NextResponse.json({error:"Comment not found"},{status:404});return i.NextResponse.json({success:!0,message:"Comment deleted successfully"})}catch(e){return console.error("Delete comment error:",e),i.NextResponse.json({error:"Failed to delete comment"},{status:500})}}let l=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/comments/[id]/route",pathname:"/api/comments/[id]",filename:"route",bundlePath:"app/api/comments/[id]/route"},resolvedPagePath:"C:\\Users\\User\\Desktop\\GITHUB\\andrewaltair\\fresh\\src\\app\\api\\comments\\[id]\\route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:f,staticGenerationAsyncStorage:g,serverHooks:y}=l,h="/api/comments/[id]/route";function x(){return(0,a.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:g})}},75748:(e,t,n)=>{n.d(t,{Z:()=>i});var r=n(11185),o=n.n(r);let s=process.env.MONGODB_URI;if(!s)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let a=global.mongoose||{conn:null,promise:null};global.mongoose||(global.mongoose=a);let i=async function(){if(a.conn)return a.conn;a.promise||(a.promise=o().connect(s,{bufferCommands:!1}).then(e=>e));try{a.conn=await a.promise}catch(e){throw a.promise=null,e}return a.conn}},84283:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(11185),o=n.n(r);let s=new r.Schema({postId:{type:String,required:[!0,"Post ID is required"],index:!0},author:{name:{type:String,required:!0},email:{type:String},avatar:{type:String},userId:{type:r.Schema.Types.ObjectId,ref:"User"}},content:{type:String,required:[!0,"Content is required"],trim:!0,maxlength:[2e3,"Comment must be less than 2000 characters"]},likes:{type:Number,default:0},parentId:{type:r.Schema.Types.ObjectId,ref:"Comment",default:null},status:{type:String,enum:["pending","approved","rejected","spam"],default:"pending"},isSpam:{type:Boolean,default:!1}},{timestamps:!0});s.index({parentId:1});let a=o().models.Comment||o().model("Comment",s)}};var t=require("../../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[8948,5972],()=>n(81729));module.exports=r})();