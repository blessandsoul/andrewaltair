"use strict";(()=>{var e={};e.id=9602,e.ids=[9602,3959],e.modules={11185:e=>{e.exports=require("mongoose")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},61104:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>x,patchFetch:()=>v,requestAsyncStorage:()=>h,routeModule:()=>f,serverHooks:()=>w,staticGenerationAsyncStorage:()=>S});var n={};r.r(n),r.d(n,{DELETE:()=>m,GET:()=>g,PUT:()=>y});var a=r(49303),i=r(88716),o=r(60670),s=r(87070),d=r(57708),l=r(75748),u=r(23959),p=r(11185),c=r.n(p);async function g(e,{params:t}){try{let e;await (0,l.Z)();let{id:r}=await t;if(c().Types.ObjectId.isValid(r)&&(e=await u.default.findById(r).lean()),e||(e=await u.default.findOne({slug:r}).lean()),!e)return s.NextResponse.json({error:"Post not found"},{status:404});await u.default.findByIdAndUpdate(e._id,{$inc:{views:1}});let[n,a]=await Promise.all([u.default.findOne({status:"published",$or:[{order:{$lt:e.order}},{order:e.order,createdAt:{$gt:e.createdAt}}]}).sort({order:-1,createdAt:1}).select("slug title").lean(),u.default.findOne({status:"published",$or:[{order:{$gt:e.order}},{order:e.order,createdAt:{$lt:e.createdAt}}]}).sort({order:1,createdAt:-1}).select("slug title").lean()]);return s.NextResponse.json({post:{...e,id:e._id.toString(),views:e.views+1},prevPost:n?{slug:n.slug,title:n.title}:null,nextPost:a?{slug:a.slug,title:a.title}:null})}catch(e){return console.error("Get post error:",e),s.NextResponse.json({error:"Failed to fetch post"},{status:500})}}async function y(e,{params:t}){try{await (0,l.Z)();let{id:r}=await t,n=await e.json();delete n.id,delete n._id;let a=await u.default.findByIdAndUpdate(r,{$set:n},{new:!0,runValidators:!0}).lean();if(!a)return s.NextResponse.json({error:"Post not found"},{status:404});return(0,d.revalidatePath)("/blog"),(0,d.revalidatePath)(`/blog/${a.slug}`),(0,d.revalidatePath)("/"),s.NextResponse.json({success:!0,post:{...a,id:a._id.toString()}})}catch(e){return console.error("Update post error:",e),s.NextResponse.json({error:"Failed to update post"},{status:500})}}async function m(e,{params:t}){try{await (0,l.Z)();let{id:e}=await t;if(!await u.default.findByIdAndDelete(e))return s.NextResponse.json({error:"Post not found"},{status:404});return(0,d.revalidatePath)("/blog"),(0,d.revalidatePath)("/"),s.NextResponse.json({success:!0,message:"Post deleted successfully"})}catch(e){return console.error("Delete post error:",e),s.NextResponse.json({error:"Failed to delete post"},{status:500})}}let f=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/posts/[id]/route",pathname:"/api/posts/[id]",filename:"route",bundlePath:"app/api/posts/[id]/route"},resolvedPagePath:"C:\\Users\\User\\Desktop\\GITHUB\\andrewaltair\\fresh\\src\\app\\api\\posts\\[id]\\route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:h,staticGenerationAsyncStorage:S,serverHooks:w}=f,x="/api/posts/[id]/route";function v(){return(0,o.patchFetch)({serverHooks:w,staticGenerationAsyncStorage:S})}},75748:(e,t,r)=>{r.d(t,{Z:()=>s});var n=r(11185),a=r.n(n);let i=process.env.MONGODB_URI;if(!i)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let o=global.mongoose||{conn:null,promise:null};global.mongoose||(global.mongoose=o);let s=async function(){if(o.conn)return o.conn;o.promise||(o.promise=a().connect(i,{bufferCommands:!1}).then(e=>e));try{o.conn=await o.promise}catch(e){throw o.promise=null,e}return o.conn}},23959:(e,t,r)=>{r.r(t),r.d(t,{default:()=>g});var n=r(11185),a=r.n(n);let i=new n.Schema({fire:{type:Number,default:0},love:{type:Number,default:0},mindblown:{type:Number,default:0},applause:{type:Number,default:0},insightful:{type:Number,default:0}},{_id:!1}),o=new n.Schema({metaTitle:{type:String,maxlength:60},metaDescription:{type:String,maxlength:160},keywords:{type:String},canonicalUrl:{type:String},focusKeyword:{type:String},seoScore:{type:Number,min:0,max:100},ogImage:{type:String}},{_id:!1}),s=new n.Schema({name:{type:String,required:!0},avatar:{type:String},role:{type:String}},{_id:!1}),d=new n.Schema({icon:{type:String},title:{type:String},content:{type:String,required:!0},type:{type:String,enum:["intro","section","sarcasm","warning","tip","fact","opinion","cta","hashtags","prompt","author-comment"],default:"section"}},{_id:!1}),l=new n.Schema({horizontal:{type:String},vertical:{type:String}},{_id:!1}),u=new n.Schema({src:{type:String,required:!0},alt:{type:String},caption:{type:String}},{_id:!1}),p=new n.Schema({url:{type:String,required:!0},platform:{type:String,enum:["youtube","vimeo"],required:!0},videoId:{type:String},thumbnailUrl:{type:String}},{_id:!1}),c=new n.Schema({slug:{type:String,required:[!0,"Slug is required"],unique:!0,trim:!0},title:{type:String,required:[!0,"Title is required"],trim:!0},excerpt:{type:String,required:[!0,"Excerpt is required"],trim:!0},content:{type:String,default:""},rawContent:{type:String,default:""},coverImage:{type:String},coverImages:{type:l},gallery:{type:[u],default:[]},sections:{type:[d],default:[]},category:{type:String,required:[!0,"Category is required"],index:!0},tags:{type:[String],default:[]},author:{type:s,required:!0},publishedAt:{type:Date,default:Date.now},readingTime:{type:Number,default:5},views:{type:Number,default:0},comments:{type:Number,default:0},shares:{type:Number,default:0},reactions:{type:i,default:()=>({fire:0,love:0,mindblown:0,applause:0,insightful:0})},featured:{type:Boolean,default:!1},trending:{type:Boolean,default:!1},status:{type:String,enum:["draft","published","scheduled","archived"],default:"draft",index:!0},scheduledFor:{type:Date},order:{type:Number,default:0},seo:{type:o,default:()=>({})},videos:{type:[p],default:[]},relatedPosts:{type:[String],default:[]},numericId:{type:String,unique:!0,sparse:!0,index:!0}},{timestamps:!0});c.index({title:"text",excerpt:"text",content:"text",rawContent:"text",numericId:"text"});let g=a().models.Post||a().model("Post",c)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[8948,5972,7708],()=>r(61104));module.exports=n})();