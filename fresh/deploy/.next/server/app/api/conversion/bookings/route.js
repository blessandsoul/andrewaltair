"use strict";(()=>{var e={};e.id=5279,e.ids=[5279],e.modules={11185:e=>{e.exports=require("mongoose")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1228:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>k,patchFetch:()=>y,requestAsyncStorage:()=>x,routeModule:()=>f,serverHooks:()=>v,staticGenerationAsyncStorage:()=>h});var n={};t.r(n),t.d(n,{GET:()=>g,POST:()=>m});var o=t(49303),s=t(88716),i=t(60670),a=t(87070),u=t(75748),d=t(11185),p=t.n(d);let c=new d.Schema({userId:{type:d.Schema.Types.ObjectId,ref:"User",required:!0},expertId:{type:String,required:!0},expertName:{type:String,required:!0},date:{type:Date,required:!0},time:{type:String,required:!0},status:{type:String,enum:["pending","confirmed","completed","cancelled"],default:"pending"},notes:String},{timestamps:!0});c.index({userId:1,date:1});let l=p().models.Booking||p().model("Booking",c);async function g(e){try{await (0,u.Z)();let r=e.headers.get("x-user-id");if(!r)return a.NextResponse.json({error:"Unauthorized"},{status:401});let t=await l.find({userId:r}).sort({date:-1}).limit(10);return a.NextResponse.json({bookings:t})}catch(e){return console.error("Bookings Error:",e),a.NextResponse.json({error:"Failed to get bookings"},{status:500})}}async function m(e){try{await (0,u.Z)();let r=e.headers.get("x-user-id");if(!r)return a.NextResponse.json({error:"Unauthorized"},{status:401});let{expertId:t,expertName:n,date:o,time:s,notes:i}=await e.json();if(!t||!n||!o||!s)return a.NextResponse.json({error:"Missing required fields"},{status:400});if(await l.findOne({expertId:t,date:new Date(o),time:s,status:{$in:["pending","confirmed"]}}))return a.NextResponse.json({error:"Time slot already booked"},{status:400});let d=await l.create({userId:r,expertId:t,expertName:n,date:new Date(o),time:s,notes:i,status:"pending"});return a.NextResponse.json({success:!0,booking:d,message:"Booking created successfully"})}catch(e){return console.error("Create Booking Error:",e),a.NextResponse.json({error:"Failed to create booking"},{status:500})}}let f=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/conversion/bookings/route",pathname:"/api/conversion/bookings",filename:"route",bundlePath:"app/api/conversion/bookings/route"},resolvedPagePath:"C:\\Users\\User\\Desktop\\GITHUB\\andrewaltair\\fresh\\src\\app\\api\\conversion\\bookings\\route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:x,staticGenerationAsyncStorage:h,serverHooks:v}=f,k="/api/conversion/bookings/route";function y(){return(0,i.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:h})}},75748:(e,r,t)=>{t.d(r,{Z:()=>a});var n=t(11185),o=t.n(n);let s=process.env.MONGODB_URI;if(!s)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let i=global.mongoose||{conn:null,promise:null};global.mongoose||(global.mongoose=i);let a=async function(){if(i.conn)return i.conn;i.promise||(i.promise=o().connect(s,{bufferCommands:!1}).then(e=>e));try{i.conn=await i.promise}catch(e){throw i.promise=null,e}return i.conn}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[8948,5972],()=>t(1228));module.exports=n})();