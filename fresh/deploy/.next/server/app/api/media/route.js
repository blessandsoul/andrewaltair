"use strict";(()=>{var e={};e.id=7166,e.ids=[7166],e.modules={11185:e=>{e.exports=require("mongoose")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},66270:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>y,patchFetch:()=>h,requestAsyncStorage:()=>c,routeModule:()=>m,serverHooks:()=>f,staticGenerationAsyncStorage:()=>g});var a={};r.r(a),r.d(a,{GET:()=>u,POST:()=>p});var n=r(49303),o=r(88716),i=r(60670),d=r(87070),s=r(75748),l=r(98071);async function u(e){try{await (0,s.Z)();let{searchParams:t}=new URL(e.url),r=t.get("folder"),a=t.get("type"),n={};r&&"all"!==r&&(n.folder=r),a&&(n.type=a);let o=(await l.Z.find(n).sort({uploadedAt:-1}).lean()).map(e=>({...e,id:e._id.toString(),uploadedAt:e.uploadedAt?.toISOString?.()?.split("T")[0]||e.uploadedAt,_id:void 0}));return d.NextResponse.json({media:o})}catch(e){return console.error("Get media error:",e),d.NextResponse.json({error:"Failed to fetch media"},{status:500})}}async function p(e){try{await (0,s.Z)();let t=await e.json(),r=new l.Z({...t,uploadedAt:new Date});return await r.save(),d.NextResponse.json({success:!0,media:{...r.toObject(),id:r._id.toString()}})}catch(e){return console.error("Create media error:",e),d.NextResponse.json({error:"Failed to create media"},{status:500})}}let m=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/media/route",pathname:"/api/media",filename:"route",bundlePath:"app/api/media/route"},resolvedPagePath:"C:\\Users\\User\\Desktop\\GITHUB\\andrewaltair\\fresh\\src\\app\\api\\media\\route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:c,staticGenerationAsyncStorage:g,serverHooks:f}=m,y="/api/media/route";function h(){return(0,i.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:g})}},75748:(e,t,r)=>{r.d(t,{Z:()=>d});var a=r(11185),n=r.n(a);let o=process.env.MONGODB_URI;if(!o)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let i=global.mongoose||{conn:null,promise:null};global.mongoose||(global.mongoose=i);let d=async function(){if(i.conn)return i.conn;i.promise||(i.promise=n().connect(o,{bufferCommands:!1}).then(e=>e));try{i.conn=await i.promise}catch(e){throw i.promise=null,e}return i.conn}},98071:(e,t,r)=>{r.d(t,{Z:()=>i});var a=r(11185),n=r.n(a);let o=new a.Schema({name:{type:String,required:[!0,"Name is required"],trim:!0},url:{type:String,required:[!0,"URL is required"]},type:{type:String,enum:["image","video"],default:"image"},size:{type:String,default:"0 KB"},sizeBytes:{type:Number,default:0},width:{type:Number},height:{type:Number},altText:{type:String,default:""},caption:{type:String,default:""},folder:{type:String,default:"all"},usedIn:[{id:String,title:String,type:String}],uploadedAt:{type:Date,default:Date.now}},{timestamps:!0});o.index({name:"text",altText:"text",caption:"text"}),o.index({folder:1});let i=n().models.Media||n().model("Media",o)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[8948,5972],()=>r(66270));module.exports=a})();