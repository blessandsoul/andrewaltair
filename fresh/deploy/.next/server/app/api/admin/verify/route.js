"use strict";(()=>{var e={};e.id=4184,e.ids=[4184],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},12781:e=>{e.exports=require("stream")},73837:e=>{e.exports=require("util")},75251:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>f,patchFetch:()=>v,requestAsyncStorage:()=>d,routeModule:()=>l,serverHooks:()=>m,staticGenerationAsyncStorage:()=>c});var n={};r.r(n),r.d(n,{GET:()=>p});var i=r(49303),o=r(88716),s=r(60670),a=r(87070),u=r(45898);async function p(e){try{if(!(0,u.ZW)(e))return a.NextResponse.json({valid:!1,error:"Invalid or expired session"},{status:401});return a.NextResponse.json({valid:!0})}catch(e){return console.error("Admin verify error:",e),a.NextResponse.json({valid:!1,error:"Verification failed"},{status:500})}}let l=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/admin/verify/route",pathname:"/api/admin/verify",filename:"route",bundlePath:"app/api/admin/verify/route"},resolvedPagePath:"C:\\Users\\User\\Desktop\\GITHUB\\andrewaltair\\fresh\\src\\app\\api\\admin\\verify\\route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:d,staticGenerationAsyncStorage:c,serverHooks:m}=l,f="/api/admin/verify/route";function v(){return(0,s.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:c})}},45898:(e,t,r)=>{r.d(t,{Oh:()=>d,ZW:()=>p,m:()=>c,p$:()=>l}),r(71615);var n=r(41482),i=r.n(n);let o=process.env.ADMIN_PASSWORD,s=process.env.ADMIN_SESSION_SECRET;function a(){if(!s)throw Error("ADMIN_SESSION_SECRET environment variable is required");return s}let u=new Map;function p(e){try{let t=e.headers.get("authorization");if(!t?.startsWith("Bearer "))return!1;let r=t.substring(7),n=i().verify(r,a());return"admin"===n.role||"god"===n.role}catch{return!1}}function l(e,t){let r=u.get(t),n=Date.now();if(r&&r.count>=5){let e=n-r.lastAttempt;if(e<9e5)return{valid:!1,locked:!0,remainingAttempts:0,lockoutRemaining:Math.ceil((9e5-e)/1e3)};u.delete(t)}if(!o)return console.error("⚠️ ADMIN_PASSWORD not set in environment!"),{valid:!1,locked:!1,remainingAttempts:0};if(e===o)return u.delete(t),{valid:!0,locked:!1,remainingAttempts:5};let i=u.get(t)||{count:0,lastAttempt:n};return i.count++,i.lastAttempt=n,u.set(t,i),{valid:!1,locked:!1,remainingAttempts:5-i.count}}function d(){return i().sign({role:"admin",iat:Date.now()},a(),{expiresIn:"24h"})}function c(e="Unauthorized"){return new Response(JSON.stringify({error:e}),{status:401,headers:{"Content-Type":"application/json"}})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[8948,5972,1482,1615],()=>r(75251));module.exports=n})();